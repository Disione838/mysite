<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ –¥–æ–±—Ä—ã—Ö —Å–ø—Ä–∞—û</title>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Commissioner:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Commissioner', system-ui, sans-serif; background: #F4F7F6; overflow: hidden; }
        #map { width: 100vw; height: 100vh; filter: saturate(0.85) brightness(1.05); }
        .glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.4); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); }
        .header { position: absolute; top: 20px; left: 20px; z-index: 1000; display: flex; align-items: center; gap: 12px; padding: 16px 24px; border-radius: 20px; font-size: 24px; font-weight: 700; color: #2c3e50; }
        .header-right { position: absolute; top: 20px; right: 20px; z-index: 1000; display: flex; gap: 12px; }
        .auth-btn { padding: 12px 24px; border-radius: 16px; border: none; font-weight: 600; cursor: pointer; font-family: inherit; transition: all 0.2s; font-size: 14px; }
        .auth-btn.login { background: white; color: #2c3e50; border: 2px solid #2c3e50; }
        .auth-btn.login:hover { background: #2c3e50; color: white; }
        .auth-btn.admin { background: linear-gradient(135deg, #9B59B6 0%, #8E44AD 100%); color: white; box-shadow: 0 4px 12px rgba(155, 89, 182, 0.3); }
        .auth-btn.admin:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(155, 89, 182, 0.4); }
        .user-menu { background: white; padding: 12px 20px; border-radius: 16px; display: flex; align-items: center; gap: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .user-avatar { width: 32px; height: 32px; border-radius: 50%; background: linear-gradient(135deg, #2ECC71 0%, #27AE60 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; }
        .user-name { font-size: 14px; font-weight: 600; color: #2c3e50; }
        .logout-btn { background: none; border: none; color: #95a5a6; cursor: pointer; font-size: 20px; padding: 4px; }
        .logout-btn:hover { color: #e74c3c; }
        .admin-tabs { display: flex; gap: 8px; margin-bottom: 24px; background: #f0f0f0; padding: 4px; border-radius: 12px; }
        .admin-tab { flex: 1; padding: 12px; background: transparent; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .admin-tab.active { background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .admin-content { display: none; }
        .admin-content.active { display: block; }
        .deed-item { border: 2px solid #e0e0e0; border-radius: 16px; padding: 16px; margin-bottom: 16px; }
        .deed-actions { display: flex; gap: 8px; flex-wrap: wrap; }
        .deed-actions .btn { padding: 8px 16px; font-size: 14px; }
        .filter-panel { position: absolute; top: 120px; left: 20px; z-index: 1000; border-radius: 24px; padding: 24px; min-width: 260px; }
        .filter-title { font-size: 18px; font-weight: 600; color: #2c3e50; margin-bottom: 20px; }
        .category-btn { display: flex; align-items: center; gap: 16px; padding: 16px 20px; border-radius: 20px; margin-bottom: 12px; cursor: pointer; border: 2.5px solid #2c3e50; background: white; width: 100%; font-family: inherit; font-size: 16px; transition: all 0.3s; }
        .category-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12); }
        .category-btn.active { background: #2c3e50; color: white; }
        .add-btn { position: absolute; bottom: 40px; right: 40px; z-index: 1000; width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(135deg, #2ECC71 0%, #27AE60 100%); border: none; color: white; font-size: 32px; cursor: pointer; box-shadow: 0 8px 24px rgba(46, 204, 113, 0.4); transition: transform 0.3s; }
        .add-btn:hover { transform: scale(1.1); }
        .custom-marker { width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); position: relative; }
        .marker-badge { position: absolute; top: -4px; right: -4px; width: 20px; height: 20px; background: #e74c3c; border-radius: 50%; font-size: 11px; color: white; font-weight: 700; border: 2px solid white; display: flex; align-items: center; justify-content: center; }
        .leaflet-popup-content-wrapper { border-radius: 16px; padding: 0; }
        .popup-body { padding: 16px; }
        .popup-title { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); z-index: 2000; align-items: center; justify-content: center; padding: 20px; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 24px; padding: 32px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto; }
        .auth-tabs { display: flex; gap: 8px; margin-bottom: 24px; background: #f0f0f0; padding: 4px; border-radius: 12px; }
        .auth-tab { flex: 1; padding: 12px; background: transparent; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .auth-tab.active { background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .auth-form { display: none; }
        .auth-form.active { display: block; }
        .error-message { background: #fee; border: 1px solid #fcc; color: #c33; padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 14px; }
        .success-message { background: #efe; border: 1px solid #cfc; color: #3c3; padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 14px; }
        .map-picker-btn { width: 100%; padding: 12px; border: 2px dashed #2ECC71; border-radius: 12px; background: rgba(46, 204, 113, 0.05); color: #2ECC71; font-weight: 600; cursor: pointer; font-family: inherit; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .map-picker-btn:hover { background: rgba(46, 204, 113, 0.1); border-color: #27AE60; }
        .map-picker-btn.selected { border-color: #27AE60; background: rgba(46, 204, 113, 0.15); }
        .map-picker-overlay { display: none; position: fixed; inset: 0; background: white; z-index: 3000; flex-direction: column; }
        .map-picker-overlay.active { display: flex; }
        .map-picker-header { padding: 20px; background: #2c3e50; color: white; display: flex; justify-content: space-between; align-items: center; }
        .map-picker-map { flex: 1; position: relative; }
        #mapPicker { width: 100%; height: 100%; }
        .map-picker-crosshair { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 48px; height: 48px; background: #2ECC71; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(46, 204, 113, 0.4); pointer-events: none; z-index: 400; }
        .map-picker-info { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); background: white; padding: 16px 24px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); z-index: 401; text-align: center; }
        .map-picker-coords { font-size: 14px; color: #666; margin-bottom: 8px; }
        .coords-display { display: inline-block; padding: 4px 12px; background: #f0f0f0; border-radius: 8px; margin-top: 8px; font-size: 12px; color: #666; }
        
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è */
        @media (max-width: 768px) {
            .header {
                top: 10px;
                left: 10px;
                padding: 12px 16px;
                font-size: 18px;
                max-width: calc(100% - 100px);
            }
            
            .header span:last-child {
                display: none;
            }
            
            .header-right {
                top: 10px;
                right: 10px;
                flex-direction: column;
                gap: 8px;
            }
            
            .auth-btn {
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .user-menu {
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .user-name {
                display: none;
            }
            
            .filter-panel {
                position: fixed;
                top: auto;
                bottom: 80px;
                left: 0;
                right: 0;
                z-index: 1000;
                border-radius: 24px 24px 0 0;
                padding: 16px;
                max-height: 50vh;
                overflow-y: auto;
                transform: translateY(calc(100% + 80px));
                transition: transform 0.3s ease;
            }
            
            .filter-panel.open {
                transform: translateY(0);
            }
            
            .filter-toggle {
                display: flex;
                position: fixed;
                bottom: 20px;
                left: 20px;
                z-index: 999;
                width: 56px;
                height: 56px;
                border-radius: 50%;
                background: white;
                border: 2px solid #2c3e50;
                align-items: center;
                justify-content: center;
                font-size: 24px;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            }
            
            .add-btn {
                bottom: 20px;
                right: 20px;
                width: 56px;
                height: 56px;
                font-size: 28px;
            }
            
            .filter-title {
                font-size: 16px;
                margin-bottom: 12px;
            }
            
            .category-btn {
                padding: 12px 16px;
                font-size: 14px;
                margin-bottom: 8px;
            }
            
            .modal-content {
                max-width: 95%;
                padding: 20px;
                margin: 10px;
            }
            
            .deed-item {
                padding: 12px;
            }
            
            .deed-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .deed-actions .btn {
                width: 100%;
            }
            
            .leaflet-popup-content-wrapper {
                max-width: 90vw;
            }
            
            .popup-body {
                font-size: 12px;
            }
            
            .popup-title {
                font-size: 14px;
            }
        }
        
        .filter-toggle {
            display: none;
        }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-weight: 600; margin-bottom: 8px; }
        .form-input, .form-textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 12px; font-family: inherit; }
        .form-textarea { min-height: 100px; resize: vertical; }
        .btn { padding: 14px 28px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; font-family: inherit; transition: all 0.2s; }
        .btn-primary { background: #2ECC71; color: white; width: 100%; }
        .btn-primary:hover { background: #27AE60; transform: translateY(-2px); }
        .loading { position: absolute; inset: 0; background: rgba(255, 255, 255, 0.9); display: flex; align-items: center; justify-content: center; z-index: 3000; font-size: 24px; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="header glass"><span style="font-size: 32px;">ü§ù</span><span>–ö–∞—Ä—Ç–∞ –¥–æ–±—Ä—ã—Ö —Å–ø—Ä–∞—û</span></div>
    
    <button class="filter-toggle glass" id="filterToggle" onclick="toggleFilters()">
        üîΩ
    </button>
    
    <div class="header-right">
        <div id="authButtons" style="display: none;">
            <button class="auth-btn login glass" onclick="openAuthModal()">–í–æ–π—Ç–∏</button>
        </div>
        <div id="userMenu" style="display: none;">
            <button class="auth-btn login glass" onclick="openProfileModal()" style="margin-right: 12px;">
                üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
            </button>
            <div class="user-menu">
                <div class="user-avatar" id="userAvatar"></div>
                <div class="user-name" id="userName"></div>
                <button class="logout-btn" onclick="logout()" title="–í—ã–π—Ç–∏">‚èª</button>
            </div>
        </div>
        <button id="adminBtn" class="auth-btn admin glass" onclick="openAdminPanel()" style="display: none;">
            üëë –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        </button>
    </div>
    
    <div class="filter-panel glass" id="filterPanel">
        <div class="filter-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
        <div id="categories"></div>
    </div>
    
    <button class="add-btn" onclick="openModal()">+</button>
    <div id="modal" class="modal">
        <div class="modal-content">
            <h2>–î–æ–±–∞–≤–∏—Ç—å –¥–æ–±—Ä–æ–µ –¥–µ–ª–æ</h2>
            <form id="deedForm" onsubmit="submitDeed(event)">
                <div class="form-group"><label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" class="form-input" name="title" required></div>
                <div class="form-group"><label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label><textarea class="form-textarea" name="description" required></textarea></div>
                <div class="form-group"><label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label><select class="form-input" name="category" required><option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option><option value="ecology">üå± –≠–∫–æ–ª–æ–≥–∏—è</option><option value="animals">üêæ –ñ–∏–≤–æ—Ç–Ω—ã–µ</option><option value="elderly">üë¥ –ü–æ–∂–∏–ª—ã–µ –ª—é–¥–∏</option><option value="children">üë∂ –î–µ—Ç–∏</option><option value="other">üí´ –î—Ä—É–≥–æ–µ</option></select></div>
                <div class="form-group">
                    <label class="form-label">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</label>
                    <button type="button" class="map-picker-btn" id="pickLocationBtn" onclick="openMapPicker()">
                        <span id="locationBtnText">üìç –í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</span>
                    </button>
                    <div id="coordsDisplay" class="coords-display" style="display: none; margin-top: 8px;"></div>
                    <input type="hidden" name="lat" id="selectedLat">
                    <input type="hidden" name="lng" id="selectedLng">
                </div>
                <div class="form-group"><label class="form-label">–ê–¥—Ä–µ—Å</label><input type="text" class="form-input" name="address" id="addressInput" required></div>
                <div class="form-group"><label class="form-label">–í–∞—à–µ –∏–º—è</label><input type="text" class="form-input" name="contactName" required></div>
                <div class="form-group"><label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label><input type="tel" class="form-input" name="contactPhone" placeholder="+375..." required></div>
                <div class="form-group"><label class="form-label">–ù—É–∂–Ω–æ –≤–æ–ª–æ–Ω—Ç—ë—Ä–æ–≤</label><input type="number" class="form-input" name="volunteersNeeded" value="1" min="1" required></div>
                <div class="form-group"><label class="form-label">–°—Ä–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label><input type="date" class="form-input" name="deadline"></div>
                <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn" onclick="closeModal()" style="margin-top: 10px; background: #95a5a6; color: white; width: 100%;">–û—Ç–º–µ–Ω–∞</button>
            </form>
        </div>
    </div>
    
    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
                <button class="modal-close" onclick="closeAuthModal()">√ó</button>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">–í—Ö–æ–¥</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <div id="authError" class="error-message" style="display: none;"></div>
            <div id="authSuccess" class="success-message" style="display: none;"></div>
            
            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" name="email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-input" name="password" required>
                </div>
                <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
            </form>
            
            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <form id="registerForm" class="auth-form" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label class="form-label">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è</label>
                    <input type="text" class="form-input" name="fullName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" name="email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)</label>
                    <input type="password" class="form-input" name="password" minlength="6" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ì–æ—Ä–æ–¥</label>
                    <input type="text" class="form-input" name="city" value="–ú–∏–Ω—Å–∫" required>
                </div>
                <button type="submit" class="btn btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
        </div>
    </div>
    
    <div id="adminModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title">üëë –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
                <button class="modal-close" onclick="closeAdminPanel()">√ó</button>
            </div>
            
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="switchAdminTab('pending')">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</button>
                <button class="admin-tab" onclick="switchAdminTab('all')">–í—Å–µ –¥–µ–ª–∞</button>
            </div>
            
            <div id="pendingContent" class="admin-content active">
                <h3 style="margin-bottom: 16px;">–î–µ–ª–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
                <div id="pendingDeeds"></div>
            </div>
            
            <div id="allContent" class="admin-content">
                <h3 style="margin-bottom: 16px;">–í—Å–µ –¥–µ–ª–∞ –Ω–∞ –∫–∞—Ä—Ç–µ</h3>
                <div id="allDeeds"></div>
            </div>
        </div>
    </div>
    
    <div id="editDeedModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ–ª–æ</h2>
                <button class="modal-close" onclick="closeEditDeedModal()">√ó</button>
            </div>
            <form id="editDeedForm" onsubmit="updateDeed(event)">
                <input type="hidden" id="editDeedId" name="deedId">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="editTitle" name="title" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="form-textarea" id="editDescription" name="description" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-input" id="editCategory" name="category" required>
                        <option value="ecology">üå± –≠–∫–æ–ª–æ–≥–∏—è</option>
                        <option value="animals">üêæ –ñ–∏–≤–æ—Ç–Ω—ã–µ</option>
                        <option value="elderly">üë¥ –ü–æ–∂–∏–ª—ã–µ –ª—é–¥–∏</option>
                        <option value="children">üë∂ –î–µ—Ç–∏</option>
                        <option value="other">üí´ –î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ê–¥—Ä–µ—Å</label>
                    <input type="text" class="form-input" id="editAddress" name="address" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ</label>
                    <input type="text" class="form-input" id="editContactName" name="contactName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" class="form-input" id="editContactPhone" name="contactPhone" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù—É–∂–Ω–æ –≤–æ–ª–æ–Ω—Ç—ë—Ä–æ–≤</label>
                    <input type="number" class="form-input" id="editVolunteersNeeded" name="volunteersNeeded" min="1" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                    <select class="form-input" id="editStatus" name="status" required>
                        <option value="pending">–í –æ–∂–∏–¥–∞–Ω–∏–∏</option>
                        <option value="approved">–û–¥–æ–±—Ä–µ–Ω–æ</option>
                        <option value="active">–ê–∫—Ç–∏–≤–Ω–æ</option>
                        <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                        <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                <button type="button" class="btn" onclick="closeEditDeedModal()" style="margin-top: 10px; background: #95a5a6; color: white; width: 100%;">–û—Ç–º–µ–Ω–∞</button>
            </form>
        </div>
    </div>
    
    <div id="profileModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title">üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
                <button class="modal-close" onclick="closeProfileModal()">√ó</button>
            </div>
            
            <div id="profileContent">
                <h3 style="margin-bottom: 16px;">–ú–æ–∏ –æ—Ç–∫–ª–∏–∫–∏</h3>
                <div id="myDeeds"></div>
            </div>
        </div>
    </div>
    
    <div id="mapPickerOverlay" class="map-picker-overlay">
        <div class="map-picker-header">
            <h2 style="margin: 0; font-size: 20px;">üìç –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ</h2>
            <button onclick="closeMapPicker()" style="background: none; border: none; color: white; font-size: 32px; cursor: pointer; line-height: 1;">√ó</button>
        </div>
        <div class="map-picker-map">
            <div id="mapPicker"></div>
            <div class="map-picker-crosshair">üìç</div>
            <div class="map-picker-info">
                <div class="map-picker-coords" id="pickerCoords">–ü–µ—Ä–µ–º–µ—â–∞–π—Ç–µ –∫–∞—Ä—Ç—É –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–æ—á–∫–∏</div>
                <button onclick="confirmLocation()" class="btn btn-primary" style="width: auto; padding: 10px 30px;">‚úì –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>
    <div id="loading" class="loading hidden"><div>‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div></div>
    <script>
        const SUPABASE_URL = 'https://jjugpxgnibblvtffisfl.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqdWdweGduaWJibHZ0ZmZpc2ZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MzczMDAsImV4cCI6MjA4NjQxMzMwMH0.6SdXki8mIZp31FVe3iByfOfU3TXzPLYwJzz3a8Aof7Y';
        var supabase, map, pickerMap;
        var markers = [];
        var selectedCategories = [];
        var selectedLocation = { lat: null, lng: null };
        var currentUser = null;
        var userRole = null;
        const categories = {
            ecology: { id: 'ecology', name: '–≠–∫–æ–ª–æ–≥–∏—è', icon: 'üå±', color: '#2ECC71' },
            animals: { id: 'animals', name: '–ñ–∏–≤–æ—Ç–Ω—ã–µ', icon: 'üêæ', color: '#E67E22' },
            elderly: { id: 'elderly', name: '–ü–æ–∂–∏–ª—ã–µ –ª—é–¥–∏', icon: 'üë¥', color: '#9B59B6' },
            children: { id: 'children', name: '–î–µ—Ç–∏', icon: 'üë∂', color: '#3498DB' },
            other: { id: 'other', name: '–î—Ä—É–≥–æ–µ', icon: 'üí´', color: '#95A5A6' }
        };
        const demoDeeds = [{id:1,title:'–£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞ –ß–µ–ª—é—Å–∫–∏–Ω—Ü–µ–≤',description:'–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å –≤ —É–±–æ—Ä–∫–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –ø–∞—Ä–∫–∞.',category:'ecology',lat:53.9045,lng:27.5615,address:'–ü–∞—Ä–∫ –ß–µ–ª—é—Å–∫–∏–Ω—Ü–µ–≤, –ú–∏–Ω—Å–∫',volunteersNeeded:15,volunteersRegistered:8},{id:2,title:'–ü–æ–º–æ—â—å –ø—Ä–∏—é—Ç—É –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö',description:'–ü—Ä–∏—é—Ç—É —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–º–æ—â—å –≤ —É—Ö–æ–¥–µ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏.',category:'animals',lat:53.8900,lng:27.5500,address:'—É–ª. –ö–∞—Ä–≤–∞—Ç–∞ 5, –ú–∏–Ω—Å–∫',volunteersNeeded:5,volunteersRegistered:3},{id:3,title:'–ü–æ–º–æ—â—å –ø–æ–∂–∏–ª—ã–º –ª—é–¥—è–º',description:'–û—Ä–≥–∞–Ω–∏–∑—É–µ–º –ø–æ–º–æ—â—å —Å –ø–æ–∫—É–ø–∫–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤.',category:'elderly',lat:53.9200,lng:27.5800,address:'–ú–∏–∫—Ä–æ—Ä–∞–π–æ–Ω –í–æ—Å—Ç–æ–∫, –ú–∏–Ω—Å–∫',volunteersNeeded:10,volunteersRegistered:10}];
        async function init() {
            // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            if (window.mapInitialized) {
                console.log('–ö–∞—Ä—Ç–∞ —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                return;
            }
            window.mapInitialized = true;
            
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');
            try { 
                if (window.supabase) { 
                    supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY); 
                    console.log('Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é
                    await checkUser();
                    
                    // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    supabase.auth.onAuthStateChange((event, session) => {
                        console.log('Auth state changed:', event);
                        if (session) {
                            currentUser = session.user;
                            updateUIForUser();
                        } else {
                            currentUser = null;
                            updateUIForGuest();
                        }
                    });
                } 
            } catch (e) { 
                console.warn('Supabase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω', e); 
            }
            
            map = L.map('map').setView([53.9045, 27.5615], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: '¬© OpenStreetMap'}).addTo(map);
            L.control.zoom({ position: 'topright' }).addTo(map);
            renderCategories();
            await loadDeeds();
            console.log('–ì–æ—Ç–æ–≤–æ!');
        }
        function renderCategories() {
            const container = document.getElementById('categories');
            Object.values(categories).forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.innerHTML = `<span style="font-size: 24px;">${cat.icon}</span><span>${cat.name}</span>`;
                btn.onclick = () => toggleCategory(cat.id, btn);
                container.appendChild(btn);
            });
        }
        function toggleCategory(catId, btn) {
            const index = selectedCategories.indexOf(catId);
            if (index > -1) { selectedCategories.splice(index, 1); btn.classList.remove('active'); } else { selectedCategories.push(catId); btn.classList.add('active'); }
            loadDeeds();
        }
        async function loadDeeds() {
            showLoading(true);
            let deeds = [];
            try {
                if (supabase) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º RPC —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–ª —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
                    const { data, error } = await supabase.rpc('get_deeds_with_coordinates', {
                        status_filter: ['approved', 'active']
                    });
                    
                    if (data && !error) {
                        deeds = data.map(d => ({
                            id: d.id,
                            title: d.title,
                            description: d.description,
                            category: d.category,
                            lat: parseFloat(d.lat),
                            lng: parseFloat(d.lng),
                            address: d.address,
                            volunteersNeeded: d.volunteers_needed || 1,
                            volunteersRegistered: d.volunteers_registered || 0,
                            images: d.images,
                            deadline: d.deadline
                        }));
                        console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ –¥–µ–ª –∏–∑ Supabase:', deeds.length);
                        if (deeds.length > 0) {
                            console.log('–ü–µ—Ä–≤–æ–µ –¥–µ–ª–æ:', deeds[0]);
                        }
                    } else if (error) {
                        console.error('–û—à–∏–±–∫–∞ Supabase:', error);
                    }
                }
            } catch (e) { 
                console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ Supabase:', e); 
            }
            
            if (deeds.length === 0) { 
                deeds = demoDeeds; 
                console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ'); 
            }
            
            if (selectedCategories.length > 0) {
                deeds = deeds.filter(d => selectedCategories.includes(d.category));
            }
            
            updateMarkers(deeds);
            showLoading(false);
        }
        function updateMarkers(deeds) {
            markers.forEach(m => map.removeLayer(m));
            markers = [];
            deeds.forEach(deed => {
                const cat = categories[deed.category];
                const spotsLeft = deed.volunteersNeeded - deed.volunteersRegistered;
                const isUrgent = deed.deadline && new Date(deed.deadline) < new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
                
                const iconHtml = `<div class="custom-marker ${isUrgent ? 'marker-pulse' : ''}" style="background-color: ${cat.color};">${cat.icon}${spotsLeft > 0 ? `<div class="marker-badge">${spotsLeft}</div>` : ''}</div>`;
                
                const marker = L.marker([deed.lat, deed.lng], {
                    icon: L.divIcon({
                        html: iconHtml,
                        className: 'custom-marker-container',
                        iconSize: [48, 48],
                        iconAnchor: [24, 24]
                    })
                });
                
                const deadlineText = deed.deadline 
                    ? `<p style="font-size: 13px; color: #666;">üìÖ –î–æ: ${new Date(deed.deadline).toLocaleDateString('ru-RU')}</p>`
                    : '';
                
                const popupContent = `
                    <div class="popup-body">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                            <span style="font-size: 24px;">${cat.icon}</span>
                            <span style="background: ${cat.color}; color: white; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 600;">${cat.name}</span>
                        </div>
                        <div class="popup-title">${deed.title}</div>
                        <p style="font-size: 13px; margin-bottom: 8px;">${deed.description}</p>
                        <p style="font-size: 13px; color: #666;">üìç ${deed.address}</p>
                        ${deadlineText}
                        <p style="font-size: 13px; color: #666; margin-top: 8px;">
                            üë• ${spotsLeft > 0 ? `–ù—É–∂–Ω–æ –µ—â—ë ${spotsLeft} –≤–æ–ª–æ–Ω—Ç—ë—Ä${spotsLeft === 1 ? '' : spotsLeft < 5 ? '–∞' : '–æ–≤'}` : '–ù–∞–±–æ—Ä –∑–∞–≤–µ—Ä—à—ë–Ω'}
                        </p>
                        <div style="margin-top: 12px;">
                            <button class="popup-volunteer-btn" onclick="volunteerForDeed('${deed.id}')" ${spotsLeft === 0 ? 'disabled' : ''} style="width: 100%; padding: 10px; background: ${spotsLeft === 0 ? '#95a5a6' : '#2ECC71'}; color: white; border: none; border-radius: 12px; font-weight: 600; cursor: ${spotsLeft === 0 ? 'not-allowed' : 'pointer'}; font-family: inherit;">
                                ${spotsLeft === 0 ? '‚úì –ù–∞–±–æ—Ä –∑–∞–≤–µ—Ä—à—ë–Ω' : 'üôã –û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è'}
                            </button>
                        </div>
                    </div>
                `;
                
                marker.bindPopup(popupContent, {
                    maxWidth: 280,
                    className: 'custom-popup'
                });
                
                marker.addTo(map);
                markers.push(marker);
            });
        }
        function openModal() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º —Ñ–æ—Ä–º—ã
            if (!currentUser) {
                alert('‚ö†Ô∏è –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                openAuthModal();
                return;
            }
            document.getElementById('modal').classList.add('active');
        }
        
        async function checkUser() {
            if (!supabase) return;
            
            try {
                const { data: { session } } = await supabase.auth.getSession();
                if (session) {
                    currentUser = session.user;
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const { data: userData } = await supabase
                        .from('users')
                        .select('role, full_name')
                        .eq('id', currentUser.id)
                        .single();
                    
                    if (userData) {
                        userRole = userData.role;
                        currentUser.full_name = userData.full_name;
                    }
                    
                    updateUIForUser();
                } else {
                    updateUIForGuest();
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', e);
                updateUIForGuest();
            }
        }
        
        function updateUIForUser() {
            document.getElementById('authButtons').style.display = 'none';
            document.getElementById('userMenu').style.display = 'block';
            
            const userName = currentUser.full_name || currentUser.email.split('@')[0];
            document.getElementById('userName').textContent = userName;
            document.getElementById('userAvatar').textContent = userName.charAt(0).toUpperCase();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
            if (userRole === 'admin' || userRole === 'moderator') {
                document.getElementById('adminBtn').style.display = 'block';
            }
        }
        
        function updateUIForGuest() {
            document.getElementById('authButtons').style.display = 'block';
            document.getElementById('userMenu').style.display = 'none';
            document.getElementById('adminBtn').style.display = 'none';
        }
        
        function openAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }
        
        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
            document.getElementById('authError').style.display = 'none';
            document.getElementById('authSuccess').style.display = 'none';
            document.getElementById('loginForm').reset();
            document.getElementById('registerForm').reset();
        }
        
        function switchAuthTab(tab) {
            const tabs = document.querySelectorAll('.auth-tab');
            const forms = document.querySelectorAll('.auth-form');
            
            tabs.forEach(t => t.classList.remove('active'));
            forms.forEach(f => f.classList.remove('active'));
            
            if (tab === 'login') {
                tabs[0].classList.add('active');
                document.getElementById('loginForm').classList.add('active');
            } else {
                tabs[1].classList.add('active');
                document.getElementById('registerForm').classList.add('active');
            }
            
            document.getElementById('authError').style.display = 'none';
        }
        
        async function handleLogin(e) {
            e.preventDefault();
            showLoading(true);
            
            const formData = new FormData(e.target);
            const email = formData.get('email');
            const password = formData.get('password');
            
            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (error) throw error;
                
                console.log('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥:', data);
                closeAuthModal();
                alert('‚úÖ –í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                const errorDiv = document.getElementById('authError');
                errorDiv.textContent = '‚ùå ' + (error.message || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞');
                errorDiv.style.display = 'block';
            }
            
            showLoading(false);
        }
        
        async function handleRegister(e) {
            e.preventDefault();
            showLoading(true);
            
            const formData = new FormData(e.target);
            const email = formData.get('email');
            const password = formData.get('password');
            const fullName = formData.get('fullName');
            const city = formData.get('city');
            
            try {
                // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const { data: authData, error: authError } = await supabase.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        data: {
                            full_name: fullName,
                            city: city
                        }
                    }
                });
                
                if (authError) throw authError;
                
                // –°–æ–∑–¥–∞—ë–º –ø—Ä–æ—Ñ–∏–ª—å —á–µ—Ä–µ–∑ RPC —Ñ—É–Ω–∫—Ü–∏—é (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–±)
                const { error: profileError } = await supabase.rpc('create_user_profile', {
                    p_user_id: authData.user.id,
                    p_email: email,
                    p_full_name: fullName,
                    p_city: city
                });
                
                if (profileError) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:', profileError);
                    // –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –µ—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –Ω–µ —Å–æ–∑–¥–∞–ª—Å—è
                    // –û–Ω —Å–æ–∑–¥–∞—Å—Ç—Å—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–º –∏–ª–∏ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–æ–∑–∂–µ
                }
                
                const successDiv = document.getElementById('authSuccess');
                successDiv.textContent = '‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –ú–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.';
                successDiv.style.display = 'block';
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    switchAuthTab('login');
                    // –ó–∞–ø–æ–ª–Ω—è–µ–º email
                    document.querySelector('#loginForm input[name="email"]').value = email;
                }, 2000);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                const errorDiv = document.getElementById('authError');
                let errorMessage = error.message || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏';
                
                // –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
                if (errorMessage.includes('already registered')) {
                    errorMessage = '–≠—Ç–æ—Ç email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω';
                } else if (errorMessage.includes('invalid email')) {
                    errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
                } else if (errorMessage.includes('password')) {
                    errorMessage = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
                }
                
                errorDiv.textContent = '‚ùå ' + errorMessage;
                errorDiv.style.display = 'block';
            }
            
            showLoading(false);
        }
        
        async function logout() {
            if (!supabase) return;
            
            try {
                await supabase.auth.signOut();
                currentUser = null;
                userRole = null;
                updateUIForGuest();
                alert('‚úÖ –í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
            }
        }
        
        async function openAdminPanel() {
            if (!currentUser || (userRole !== 'admin' && userRole !== 'moderator')) {
                alert('‚ö†Ô∏è –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞');
                return;
            }
            
            document.getElementById('adminModal').classList.add('active');
            await loadPendingDeeds();
        }
        
        function closeAdminPanel() {
            document.getElementById('adminModal').classList.remove('active');
        }
        
        function switchAdminTab(tab) {
            const tabs = document.querySelectorAll('.admin-tab');
            const contents = document.querySelectorAll('.admin-content');
            
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            
            if (tab === 'pending') {
                tabs[0].classList.add('active');
                document.getElementById('pendingContent').classList.add('active');
                loadPendingDeeds();
            } else {
                tabs[1].classList.add('active');
                document.getElementById('allContent').classList.add('active');
                loadAllDeeds();
            }
        }
        
        async function loadAllDeeds() {
            showLoading(true);
            try {
                const { data, error } = await supabase.rpc('get_deeds_with_coordinates', {
                    status_filter: ['approved', 'active', 'completed']
                });
                
                if (error) throw error;
                
                const container = document.getElementById('allDeeds');
                if (!data || data.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">–ù–µ—Ç –¥–µ–ª –Ω–∞ –∫–∞—Ä—Ç–µ</p>';
                    showLoading(false);
                    return;
                }
                
                container.innerHTML = data.map(deed => {
                    const cat = categories[deed.category];
                    return `
                        <div class="deed-item">
                            <div style="display: flex; gap: 16px; align-items: start;">
                                <div style="font-size: 48px;">${cat.icon}</div>
                                <div style="flex: 1;">
                                    <h4 style="margin-bottom: 8px;">${deed.title}</h4>
                                    <p style="font-size: 14px; color: #666; margin-bottom: 8px;">${deed.description}</p>
                                    <p style="font-size: 13px; color: #999;">üìç ${deed.address}</p>
                                    <p style="font-size: 13px; color: #999;">üë§ ${deed.contact_name} ‚Ä¢ üìû ${deed.contact_phone}</p>
                                    <p style="font-size: 13px; color: #999;">üë• ${deed.volunteers_registered || 0} / ${deed.volunteers_needed}</p>
                                    <p style="font-size: 13px; color: #999;">üìä –°—Ç–∞—Ç—É—Å: <strong>${getStatusText(deed.status)}</strong></p>
                                </div>
                                <div class="deed-actions">
                                    <button onclick="openEditDeed('${deed.id}')" class="btn" style="background: #3498DB; color: white;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                    <button onclick="deleteDeedConfirm('${deed.id}')" class="btn" style="background: #e74c3c; color: white;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–ª:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
            }
            showLoading(false);
        }
        
        function getStatusText(status) {
            const statuses = {
                'pending': '–í –æ–∂–∏–¥–∞–Ω–∏–∏',
                'approved': '–û–¥–æ–±—Ä–µ–Ω–æ',
                'active': '–ê–∫—Ç–∏–≤–Ω–æ',
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
                'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ'
            };
            return statuses[status] || status;
        }
        
        async function loadPendingDeeds() {
            showLoading(true);
            try {
                const { data, error } = await supabase.rpc('get_deeds_with_coordinates', {
                    status_filter: ['pending']
                });
                
                if (error) throw error;
                
                const container = document.getElementById('pendingDeeds');
                if (!data || data.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">–ù–µ—Ç –¥–µ–ª –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</p>';
                    showLoading(false);
                    return;
                }
                
                container.innerHTML = data.map(deed => {
                    const cat = categories[deed.category];
                    return `
                        <div style="border: 2px solid #e0e0e0; border-radius: 16px; padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; gap: 16px; align-items: start;">
                                <div style="font-size: 48px;">${cat.icon}</div>
                                <div style="flex: 1;">
                                    <h4 style="margin-bottom: 8px;">${deed.title}</h4>
                                    <p style="font-size: 14px; color: #666; margin-bottom: 8px;">${deed.description}</p>
                                    <p style="font-size: 13px; color: #999;">üìç ${deed.address}</p>
                                    <p style="font-size: 13px; color: #999;">üë§ ${deed.contact_name} ‚Ä¢ üìû ${deed.contact_phone}</p>
                                    <p style="font-size: 13px; color: #999;">üë• –ù—É–∂–Ω–æ: ${deed.volunteers_needed}</p>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <button onclick="approveDeed('${deed.id}')" class="btn" style="background: #2ECC71; color: white; padding: 8px 16px;">‚úì –û–¥–æ–±—Ä–∏—Ç—å</button>
                                    <button onclick="rejectDeed('${deed.id}')" class="btn" style="background: #e74c3c; color: white; padding: 8px 16px;">‚úó –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–ª –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
            }
            showLoading(false);
        }
        
        async function approveDeed(deedId) {
            if (!confirm('–û–¥–æ–±—Ä–∏—Ç—å —ç—Ç–æ –¥–µ–ª–æ?')) return;
            
            showLoading(true);
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º RPC —Ñ—É–Ω–∫—Ü–∏—é –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ UPDATE
                const { data, error } = await supabase.rpc('approve_deed', {
                    p_deed_id: deedId
                });
                
                if (error) throw error;
                
                alert('‚úÖ –î–µ–ª–æ –æ–¥–æ–±—Ä–µ–Ω–æ!');
                await loadPendingDeeds();
                await loadDeeds();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è:', error);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
            showLoading(false);
        }
        
        async function rejectDeed(deedId) {
            if (!confirm('–û—Ç–∫–ª–æ–Ω–∏—Ç—å —ç—Ç–æ –¥–µ–ª–æ?')) return;
            
            showLoading(true);
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º RPC —Ñ—É–Ω–∫—Ü–∏—é –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ UPDATE
                const { data, error } = await supabase.rpc('reject_deed', {
                    p_deed_id: deedId
                });
                
                if (error) throw error;
                
                alert('‚úÖ –î–µ–ª–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ');
                await loadPendingDeeds();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:', error);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
            showLoading(false);
        }
        
        async function openEditDeed(deedId) {
            showLoading(true);
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–µ–ª–∞
                const { data, error } = await supabase.rpc('get_deeds_with_coordinates', {
                    status_filter: ['pending', 'approved', 'active', 'completed', 'rejected']
                });
                
                if (error) throw error;
                
                const deed = data.find(d => d.id === deedId);
                if (!deed) {
                    alert('‚ùå –î–µ–ª–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                    showLoading(false);
                    return;
                }
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('editDeedId').value = deed.id;
                document.getElementById('editTitle').value = deed.title;
                document.getElementById('editDescription').value = deed.description;
                document.getElementById('editCategory').value = deed.category;
                document.getElementById('editAddress').value = deed.address;
                document.getElementById('editContactName').value = deed.contact_name;
                document.getElementById('editContactPhone').value = deed.contact_phone;
                document.getElementById('editVolunteersNeeded').value = deed.volunteers_needed;
                document.getElementById('editStatus').value = deed.status;
                
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                document.getElementById('editDeedModal').classList.add('active');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–ª–∞:', error);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
            showLoading(false);
        }
        
        function closeEditDeedModal() {
            document.getElementById('editDeedModal').classList.remove('active');
            document.getElementById('editDeedForm').reset();
        }
        
        async function updateDeed(e) {
            e.preventDefault();
            showLoading(true);
            
            const formData = new FormData(e.target);
            const deedId = formData.get('deedId');
            
            try {
                const { error } = await supabase.rpc('update_deed', {
                    p_deed_id: deedId,
                    p_title: formData.get('title'),
                    p_description: formData.get('description'),
                    p_category: formData.get('category'),
                    p_address: formData.get('address'),
                    p_contact_name: formData.get('contactName'),
                    p_contact_phone: formData.get('contactPhone'),
                    p_volunteers_needed: parseInt(formData.get('volunteersNeeded')),
                    p_status: formData.get('status')
                });
                
                if (error) throw error;
                
                alert('‚úÖ –î–µ–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
                closeEditDeedModal();
                await loadAllDeeds();
                await loadDeeds();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
            showLoading(false);
        }
        
        async function deleteDeedConfirm(deedId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –¥–µ–ª–æ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) return;
            
            showLoading(true);
            try {
                const { error } = await supabase.rpc('delete_deed', {
                    p_deed_id: deedId
                });
                
                if (error) throw error;
                
                alert('‚úÖ –î–µ–ª–æ —É–¥–∞–ª–µ–Ω–æ');
                await loadAllDeeds();
                await loadDeeds();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
            showLoading(false);
        }
        
        async function volunteerForDeed(deedId) {
            if (!currentUser) {
                alert('‚ö†Ô∏è –î–ª—è –æ—Ç–∫–ª–∏–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                openAuthModal();
                return;
            }
            
            showLoading(true);
            try {
                const { data, error } = await supabase.rpc('volunteer_for_deed', {
                    p_deed_id: deedId
                });
                
                if (error) throw error;
                
                const result = data[0];
                if (result.success) {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    const contactInfo = `‚úÖ ${result.message}\n\nüìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n–ò–º—è: ${result.contact_name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${result.contact_phone}${result.contact_email ? `\nEmail: ${result.contact_email}` : ''}`;
                    alert(contactInfo);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç—É
                    await loadDeeds();
                } else {
                    alert('‚ö†Ô∏è ' + result.message);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–∏–∫–∞:', error);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
            showLoading(false);
        }
        
        async function openProfileModal() {
            if (!currentUser) {
                alert('‚ö†Ô∏è –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è');
                return;
            }
            
            document.getElementById('profileModal').classList.add('active');
            await loadMyDeeds();
        }
        
        function closeProfileModal() {
            document.getElementById('profileModal').classList.remove('active');
        }
        
        async function loadMyDeeds() {
            showLoading(true);
            try {
                const { data, error } = await supabase.rpc('get_my_volunteered_deeds');
                
                if (error) throw error;
                
                const container = document.getElementById('myDeeds');
                if (!data || data.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 60px 20px; color: #666;"><div style="font-size: 64px; margin-bottom: 16px;">üôã</div><p style="font-size: 18px; margin-bottom: 8px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∫–ª–∏–∫–æ–≤</p><p style="font-size: 14px;">–ù–∞–π–¥–∏—Ç–µ –¥–æ–±—Ä–æ–µ –¥–µ–ª–æ –Ω–∞ –∫–∞—Ä—Ç–µ –∏ –æ—Ç–∫–ª–∏–∫–Ω–∏—Ç–µ—Å—å!</p></div>';
                    showLoading(false);
                    return;
                }
                
                container.innerHTML = data.map(deed => {
                    const cat = categories[deed.category];
                    const deadlineText = deed.deadline ? `<p style="font-size: 13px; color: #666;">üìÖ –î–æ: ${new Date(deed.deadline).toLocaleDateString('ru-RU')}</p>` : '';
                    const statusColors = {'approved': '#2ECC71', 'active': '#3498DB', 'completed': '#95a5a6'};
                    const statusColor = statusColors[deed.status] || '#95a5a6';
                    
                    return `
                        <div class="deed-item">
                            <div style="display: flex; gap: 16px; align-items: start;">
                                <div style="font-size: 48px;">${cat.icon}</div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                        <h4 style="margin: 0;">${deed.title}</h4>
                                        <span style="background: ${statusColor}; color: white; padding: 2px 8px; border-radius: 8px; font-size: 11px;">${getStatusText(deed.status)}</span>
                                    </div>
                                    <p style="font-size: 14px; color: #666; margin-bottom: 8px;">${deed.description}</p>
                                    <p style="font-size: 13px; color: #999;">üìç ${deed.address}</p>
                                    ${deadlineText}
                                    <p style="font-size: 13px; color: #999;">üë• ${deed.volunteers_registered} / ${deed.volunteers_needed} –≤–æ–ª–æ–Ω—Ç—ë—Ä–æ–≤</p>
                                    <p style="font-size: 13px; color: #999;">üïê –û—Ç–∫–ª–∏–∫–Ω—É–ª–∏—Å—å: ${new Date(deed.volunteered_at).toLocaleDateString('ru-RU')}</p>
                                    
                                    <div style="margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 12px; border-left: 4px solid #2ECC71;">
                                        <p style="font-size: 13px; font-weight: 600; margin-bottom: 8px;">üìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</p>
                                        <p style="font-size: 13px; color: #666;">üë§ ${deed.contact_name}</p>
                                        <p style="font-size: 13px; color: #666;">üìû <a href="tel:${deed.contact_phone}" style="color: #2ECC71; text-decoration: none;">${deed.contact_phone}</a></p>
                                        ${deed.contact_email ? `<p style="font-size: 13px; color: #666;">üìß <a href="mailto:${deed.contact_email}" style="color: #2ECC71; text-decoration: none;">${deed.contact_email}</a></p>` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–ª:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
            }
            showLoading(false);
        }
        
        function closeModal() { document.getElementById('modal').classList.remove('active'); document.getElementById('deedForm').reset(); resetLocation(); }
        
        function resetLocation() {
            selectedLocation = { lat: null, lng: null };
            document.getElementById('selectedLat').value = '';
            document.getElementById('selectedLng').value = '';
            document.getElementById('locationBtnText').textContent = 'üìç –í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ';
            document.getElementById('pickLocationBtn').classList.remove('selected');
            document.getElementById('coordsDisplay').style.display = 'none';
        }
        
        function openMapPicker() {
            document.getElementById('mapPickerOverlay').classList.add('active');
            setTimeout(() => {
                if (!pickerMap) {
                    pickerMap = L.map('mapPicker').setView([53.9045, 27.5615], 12);
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '¬© OpenStreetMap'
                    }).addTo(pickerMap);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã
                    pickerMap.on('move', updatePickerCoords);
                    pickerMap.on('moveend', updatePickerCoords);
                } else {
                    pickerMap.invalidateSize();
                }
                updatePickerCoords();
            }, 100);
        }
        
        function closeMapPicker() {
            document.getElementById('mapPickerOverlay').classList.remove('active');
        }
        
        function updatePickerCoords() {
            if (!pickerMap) return;
            const center = pickerMap.getCenter();
            selectedLocation.lat = center.lat.toFixed(6);
            selectedLocation.lng = center.lng.toFixed(6);
            document.getElementById('pickerCoords').innerHTML = `
                <strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong><br>
                –®–∏—Ä–æ—Ç–∞: ${selectedLocation.lat}, –î–æ–ª–≥–æ—Ç–∞: ${selectedLocation.lng}
            `;
        }
        
        function confirmLocation() {
            if (!selectedLocation.lat || !selectedLocation.lng) return;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ —Ñ–æ—Ä–º—É
            document.getElementById('selectedLat').value = selectedLocation.lat;
            document.getElementById('selectedLng').value = selectedLocation.lng;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
            document.getElementById('locationBtnText').textContent = '‚úì –ú–µ—Å—Ç–æ –≤—ã–±—Ä–∞–Ω–æ';
            document.getElementById('pickLocationBtn').classList.add('selected');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            document.getElementById('coordsDisplay').textContent = 
                `üìç ${selectedLocation.lat}, ${selectedLocation.lng}`;
            document.getElementById('coordsDisplay').style.display = 'inline-block';
            
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${selectedLocation.lat}&lon=${selectedLocation.lng}&accept-language=ru`)
                .then(res => res.json())
                .then(data => {
                    if (data.display_name) {
                        document.getElementById('addressInput').value = data.display_name;
                    }
                })
                .catch(e => console.log('–ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ'));
            
            closeMapPicker();
        }
        async function submitDeed(e) {
            e.preventDefault();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–Ω–æ –ª–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
            const lat = parseFloat(document.getElementById('selectedLat').value);
            const lng = parseFloat(document.getElementById('selectedLng').value);
            
            if (!lat || !lng) {
                alert('‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ');
                return;
            }
            
            showLoading(true);
            const formData = new FormData(e.target);
            
            try {
                if (supabase) {
                    const deadline = formData.get('deadline');
                    
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º RPC —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
                    const { data, error } = await supabase.rpc('create_deed', {
                        p_title: formData.get('title'),
                        p_description: formData.get('description'),
                        p_category: formData.get('category'),
                        p_address: formData.get('address'),
                        p_city: '–ú–∏–Ω—Å–∫',
                        p_contact_name: formData.get('contactName'),
                        p_contact_phone: formData.get('contactPhone'),
                        p_contact_email: null,
                        p_volunteers_needed: parseInt(formData.get('volunteersNeeded')),
                        p_deadline: deadline ? new Date(deadline).toISOString() : null,
                        p_images: [],
                        p_lat: lat,
                        p_lng: lng
                    });
                    
                    if (error) throw error;
                    
                    console.log('–î–µ–ª–æ —Å–æ–∑–¥–∞–Ω–æ —Å ID:', data);
                    alert('‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é!\n\n–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ' + lat.toFixed(6) + ', ' + lng.toFixed(6));
                    closeModal();
                    await loadDeeds();
                } else { 
                    alert('‚ö†Ô∏è Supabase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –∏–∑ setup_database.sql'); 
                }
            } catch (error) { 
                console.error('–û—à–∏–±–∫–∞:', error); 
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message); 
            }
            showLoading(false);
        }
        function showLoading(show) { document.getElementById('loading').classList.toggle('hidden', !show); }
        
        function toggleFilters() {
            const panel = document.getElementById('filterPanel');
            const toggle = document.getElementById('filterToggle');
            panel.classList.toggle('open');
            toggle.textContent = panel.classList.contains('open') ? 'üîº' : 'üîΩ';
        }
        
        window.addEventListener('load', init);
    </script>
</body>
</html>
